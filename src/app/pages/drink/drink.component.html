@let drink = drink$ | async;
@let language = language$ | async;

<div class="w-full max-w-6xl mx-auto my-10 px-8">
  @if (!loading && !notFound && drink && drink.id) {
    <app-button (click)="goHome()">{{ '‚Üê ' + ('drink.home' | translate) }}</app-button>
  }
  <div class="w-full max-w-6xl mx-auto mt-10 relative">
    @if (loading) {
      <div class="flex justify-center items-center min-h-[300px]">
        <span
          class="animate-spin rounded-full h-12 w-12 border-t-4 border-b-4"
          style="border-color: var(--primary) transparent var(--primary) transparent"
        ></span>
      </div>
    }
    @if (!loading && !notFound && drink && drink.id) {
      <div class="flex flex-col lg:flex-row gap-8 items-start mt-8">
        <div class="flex-1 w-full max-w-xl mx-auto lg:mx-0">
          <div class="relative w-full aspect-[4/3] min-h-[320px] overflow-hidden rounded-xl shadow">
            <img
              [src]="drink.thumb + '/large'"
              [alt]="drink.name"
              class="w-full h-full object-cover object-center transition-transform duration-300 ease-in-out"
              loading="lazy"
            />
            <div
              class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent"
            ></div>
          </div>
        </div>
        <div class="flex-1 w-full max-w-xl mx-auto lg:mx-0">
          <div class="flex flex-wrap justify-center lg:justify-start">
            <div class="w-full py-4">
              <span class="block text-black font-bold text-2xl truncate drop-shadow-sm">
                {{ drink.name }}
              </span>
            </div>
            <div class="w-full flex flex-row flex-wrap py-2 gap-2">
              <span
                class="inline-block bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium cursor-default"
              >
                {{
                  drink.alcoholic
                    ? ('drink.alcoholic' | translate)
                    : ('drink.nonAlcoholic' | translate)
                }}
              </span>
              @if (drink.category) {
                <span
                  class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium cursor-default"
                >
                  {{ drink.category }}
                </span>
              }
              @if (drink.glassType) {
                <span
                  class="inline-block bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium cursor-default"
                >
                  {{ drink.glassType }}
                </span>
              }
            </div>
          </div>
          @if (language && drink.instructionsByLang[language]) {
            <div class="flex-1 w-full max-w-xl mx-auto lg:mx-0">
              <div class="my-4">
                <h3 class="text-lg font-semibold text-gray-800 mb-1">
                  {{ 'drink.ingredients' | translate }}
                </h3>
                <div class="w-full flex flex-row flex-wrap py-2 gap-2">
                  @for (ingredient of drink.ingredients; track ingredient.name) {
                    @if (ingredient.name) {
                      <span
                        title="See more about {{ ingredient.name }}"
                        class="inline-block px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm font-medium cursor-default"
                      >
                        {{ ingredient.measure ? ingredient.measure + ' ' : ''
                        }}{{ ingredient.name }}
                      </span>
                    }
                  }
                </div>
              </div>
              <div class="my-4">
                <h3 class="text-lg font-semibold text-gray-800 mb-1">
                  {{ 'drink.instructions' | translate }}
                </h3>
                <p class="text-gray-700 leading-relaxed">
                  {{ language ? drink.instructionsByLang[language] : '' }}
                </p>
              </div>
            </div>
          }
        </div>
      </div>
    }
    @if (!loading && notFound) {
      <app-not-found></app-not-found>
    }
  </div>
</div>
